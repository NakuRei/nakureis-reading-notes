# 探索・推論

## 探索木

- **探索木** : **ツリー構造**
    - 場合分けの一種
    - e.g. **迷路** -> 行き止まりと分岐に記号を付与 -> ツリー構造
    - e.g. **ハノイの塔** : パズルの一種、 探索木で解ける
        - 最小の手数は、$2^n - 1$（$n$ : 円盤の枚数）
- **幅優先探索** : **出発点に近いノード順**で探索 -> 出発点から遠いノードほど探索は後
    - **最短距離の解を必ず見つけられる**
    - **メモリ不足の可能性**がある : 途中で立ち寄ったノードをすべて記憶する必要があるため
- **深さ優先探索** : **あるノードから行けるところまで行き、行き止まりになったら1つ手前へ戻り**探索
    - 解が見つかったとしても**最短距離の解とは限らない**
    - 運が良ければ早く解が見つかるが、運が悪ければ時間がかかる
    - **メモリ不足になりにくい**
- ※ 探索は、最初に右側から始めたら、その後も常に右側から探索する

## プランニング（ロボットの行動計画）

- **プランニング** : 探索を利用してロボットの行動計画を作成する技術
- **STRIPS** (STanford Research Institute Problem Solver) : プランニングのための記述方法
    - 「**前提条件**」「**行動**」「**結果**」という**3つの要素の組み合わせで記述**
    - あらゆる状態の「前提条件」について「行動」と「結果」を記述することで、目標状態への行動計画を立てられる

- **SHRDLU**
    - 文字による英語の指示を受け付け、**コンピュータ上の「積み木の世界」に存在する様々な物体を動かせる**システム
        - プランニングで動かす
    - 「積み木の世界」限定だが、**自然な会話**ができた
    - 1968 - 1970年に**テリー・ウィノグラードが開発**
    - この成果はCycプロジェクトに引き継がれた

## ボードゲーム

ボードゲームは組み合わせが天文学的な数字になってしまう。

| ボードゲーム | 盤    | 組み合わせ    | 人工知能の勝利 |
| :----------- | :---- | :------------ | :------------- |
| オセロ       | 8x8   | 約 $10^{60}$  | 1997           |
| チェス       | 8x8   | 約 $10^{120}$ | 1997           |
| 将棋         | 9x9   | 約 $10^{220}$ | 2015           |
| 囲碁         | 19x19 | 約 $10^{360}$ | 2016 (AlphaGo) |

- 効率の良い探索のために**コスト**という概念を取り入れる
    - ヒューリスティックな知識を利用してコストを計算する
        - **ヒューリスティックな知識** : 人間の経験則に基づく知識
    - 各状態に、その状態の有利不利を表すコストを持たせる
    - コストの計算方法は事前に決める
        - e.g. 駒の数や位置関係から計算

- ゲーム戦略の立て方 : **Mini-Max法**
    - **自分の番ではスコアが最大**、**相手の番ではスコアが最小**になるように戦略を立てる手法
        - 自分に有利なほどスコアが大きい、相手に有利なほどスコアが小さい
    - **数手先まで先読み**し、探索木の一番下から、もっとも条件を満たすルートを選択する
        - 探索木の一番下から現時点までさかのぼり、各ノードのスコアを決定
    - すべての盤面状態を調べるため、計算量は膨大

- Mini-Max法の探索をできるだけ減らす手法 : **αβ法**
    - 探索する必要のない枝を切り落とし、不要な探索を省く
    - **αカット** : **自分の番**、最大のスコアを探索する過程で、すでに出現したスコアよりも小さいスコアのノードが出現したら、その時点でそのノードを探索対象から外す
    - **βカット** : **相手の番**、最小のスコアを選択する過程で、すでに出現したスコアよりも大きいスコアのノードが出現したら、その時点でそのノードを探索対象から外す

- **モンテカルロ法** : ゲームがある局面まで進んだら、**複数回プレイアウトさせてスコアを評価**する方法
    - **プレイアウト** : お互い完全**ランダム**に手を指し続け、とにかく終局させること
        - スコア評価は放棄
    - モンテカルロ法は**ブルートフォース**（力任せ）で押し切る方法の1つ
    - **数多く打って最良のものを選ぶ**ほうが優れているとわかった
        - 旧来の方法は局面のスコアを人間が決めていた -> コスト評価に問題があった
    - 9x9の囲碁まで通用した
    - 19x19の囲碁には通用せず -> AlphaGo（ディープラーニング）が勝利
        - 機械学習でより良い特徴量が発見された : 2つの駒の関係より、3つの駒の関係を使って盤面を評価したほうが有効だとわかった
